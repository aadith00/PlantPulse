{% load static %}

<!DOCTYPE html>
<html lang="en">
<!-- Basic -->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Site Metas -->
    <title>PlantPulse</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Site Icons -->
    <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}" type="{% static 'images/x-icon' %}">
    <link rel="apple-touch-icon" href="{% static 'images/apple-touch-icon.png' %}">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <!-- Site CSS -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <!-- Responsive CSS -->
    <link rel="stylesheet" href="{% static 'css/responsive.css' %}">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/custom.css' %}">

    <style>
        /* Custom styles to make the form section stand out */
        .main-content {
            background-image: url("{% static 'images/tomato-bg.jpg' %}");
            background-size: cover;
            padding: 80px 0;
            /* Increased padding for more space around the form */
            color: #fff;
        }

        .form-container {
            background: rgba(0, 0, 0, 0.6);
            padding: 40px;
            /* Increased padding inside the form container */
            border-radius: 8px;
            margin-top: 40px;
            /* Increased margin-top to move the form down */
            max-width: 800px;
            /* Optional: Set a max-width for better alignment */
            margin-left: auto;
            margin-right: auto;
        }

        .form-container h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            /* Added margin-bottom for spacing under the heading */
        }

        .custom-file-upload {
            background-color: #f5f5f5;
            padding: 20px;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            color: #333;
        }

        .custom-file-upload:hover {
            background-color: #e9e9e9;
        }

        .prediction-result {
            background: rgba(255, 255, 255, 0.8);
            color: #333;
            padding: 20px;
            border-radius: 5px;
            margin-top: 20px;
        }

        /* Add spacing */
        .main-content .col-lg-12 {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .image-gallery {
            margin-top: 30px;
            text-align: center;
        }

        .image-gallery img {
            width: 150px;
            margin: 10px;
            border-radius: 10px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 30px;
        }

        header {
            margin-bottom: 20px;
        }

        .product-container {
            display: flex;
            justify-content: start;
            align-items: start;
            gap: 40px;
        }

        /* .img-card{
              width: 40%;
          } */

        .img-card img {
            width: 100%;
            flex-shrink: 0;
            border-radius: 4px;
            height: 520px;
            object-fit: cover;
        }

        .small-Card {
            display: flex;
            justify-content: start;
            align-items: center;
            margin-top: 15px;
            gap: 12px;
        }

        .small-Card img {
            width: 104px;
            height: 104px;
            border-radius: 4px;
            cursor: pointer;
        }

        .small-Card img:active {
            border: 1px solid #17696a;
        }

        .sm-card {
            border: 2px solid darkred;
        }

        .product-info {
            width: 60%;
        }

        .product-info h3 {
            font-size: 32px;
            font-family: Lato;
            font-weight: 600;
            line-height: 130%;
        }

        .product-info h5 {
            font-size: 24px;
            font-family: Lato;
            font-weight: 500;
            line-height: 130%;
            color: #ff4242;
            margin: 6px 0;
        }

        .product-info del {
            color: #a9a9a9;
        }

        .product-info p {
            color: #424551;
            margin: 15px 0;
            width: 70%;
        }

        .sizes p {
            font-size: 22px;
            color: black;
        }

        .size-option {
            width: 200px;
            height: 30px;
            margin-bottom: 15px;
            padding: 5px;
        }

        .quantity input {
            width: 51px;
            height: 33px;
            margin-bottom: 15px;
            padding: 6px;
        }

        button {
            background: #17696a;
            border-radius: 4px;
            padding: 10px 37px;
            border: none;
            color: white;
            font-weight: 600;
        }

        button:hover {
            background: #ff4242;
            transition: ease-in 0.4s;
        }

        .delivery {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 70%;
            color: #787a80;
            font-size: 12px;
            font-family: Lato;
            line-height: 150%;
            letter-spacing: 1px;
        }

        hr {
            color: #787a80;
            width: 58%;
            opacity: 0.67;
        }

        .pagination {
            color: #787a80;
            margin: 15px 0;
            cursor: pointer;
        }

        @media screen and (max-width: 576px) {
            .product-container {
                flex-direction: column;
            }

            .small-Card img {
                width: 80px;
            }

            .product-info {
                width: 100%;
            }

            .md .product-info p {
                width: 100%;
            }

            .delivery {
                width: 100%;
            }

            hr {
                width: 100%;
            }
        }

        .product-container {
            display: flex;
            gap: 40px;
        }

        .img-card {
            width: 40%;
        }

        .right-side {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 55%;
        }

        .product-info {
            width: 100%;
        }

        .cards {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .address-card,
        .vendor-card {
            border: 1px solid #ddd;
            padding: 15px;
            margin-top: 20px;
        }

        .vendor-card {
            margin-top: 10px;
        }

        .page-wrapper {
            width: 100vw;
            height: 100vh;
            overflow: auto;
            /* Scroll within container if content overflows */
        }
    </style>

</head>

<body>
    <!-- Start Main Top -->
    <div class="main-top">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                    <div class="right-phone-box">
                        <p>Call US :- <a href="#">+91 XXX XXX XXXX</a></p>
                    </div>
                    <div class="our-link">
                        {% if user.is_authenticated %}
                        <ul>
                            <li><a href="#"><i class="fa fa-user s_color"></i> My Account</a></li>
                            <li><a href="{% url 'contact' %}"><i class="fas fa-headset"></i> Contact Us</a></li>
                        </ul>
                        {% else %}
                        <ul>
                            <li><a href="{% url 'contact' %}"><i class="fas fa-headset"></i> Contact Us</a></li>
                        </ul>
                        {% endif %}
                    </div>
                </div>
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                    <div class="login-box">
                        {% if user.is_authenticated %}
                        <a href="{% url 'my-account' %}" class="btn btn-primary">Welcome {{ user.username }} </a>
                        {% else %}
                        <a href="{% url 'auth' %}" class="btn btn-primary">Register / Sign In</a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Main Top -->

    <!-- Start Main Top -->
    <header class="main-header">
        <!-- Start Navigation -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light navbar-default bootsnav">

            <div class="container">
                <!-- Start Header Navigation -->
                <div class="navbar-header">
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu"
                        aria-controls="navbars-rs-food" aria-expanded="false" aria-label="Toggle navigation">
                        <i class="fa fa-bars"></i>
                    </button>
                    <a class="navbar-brand" href="{% url 'index' %}">
                        <img src="{% static 'images/newlogo.png' %}" class="logo" alt="">
                    </a>
                </div>
                <!-- End Header Navigation -->

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse" id="navbar-menu">
                    <ul class="nav navbar-nav ml-auto d-flex align-items-center" data-in="fadeInDown"
                        data-out="fadeOutUp">
                        <li class="nav-item active"><a class="nav-link" href="{% url 'index' %}">Home</a></li>
                        <li class="nav-item"><a class="nav-link" href="{% url 'model' %}">Predict</a></li>
                        <li class="nav-item"><a class="nav-link" href="{% url 'about' %}">About Us</a></li>

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle"
                                href="{% if not user.is_authenticated %}{% url 'shop-detail' %}{% else %} {% url 'shop-detail' %} {% endif %}"
                                id="shopDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">
                                SHOP
                            </a>
                            {% if user.is_authenticated %}
                            <ul class="dropdown-menu" aria-labelledby="shopDropdown">
                                <li><a class="dropdown-item" href="{% url 'cart' %}">Cart</a></li>
                                <li><a class="dropdown-item" href="{% url 'checkout' %}">Checkout</a></li>
                                <li><a class="dropdown-item" href="{% url 'my-account' %}">My Account</a></li>
                            </ul>
                            {% endif %}
                        </li>

                        <li class="nav-item"><a class="nav-link" href="{% url 'gallery' %}">Gallery</a></li>
                        <li class="nav-item"><a class="nav-link" href="{% url 'contact' %}">Contact Us</a></li>

                        {% if user.is_authenticated %}
                        <!-- Cart option before Logout -->
                        <li class="side-menu">
                            <a href="{% url 'cart' %}">
                                <p>My Cart</p>
                                <i class="fa fa-shopping-bag"></i>
                                <span class="badge cart-items-count">{{ cart_items_count }}</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'logout' %}" class="btn btn-primary ml-3">Logout</a>
                        </li>
                        {% endif %}
                    </ul>
                </div>
        </nav>
        <!-- End Navigation -->
    </header>
    <!-- End Main Top -->

    <section class="product-container">
        <!-- left side -->
        <div class="img-card">
            <img src="{{ p.image.url }}" alt="" id="featured-image">


        </div>

        <!-- Right side -->
        <div class="right-side">
            <!-- Product Information -->
            <div class="product-info">
                <h3>{{ p.title }}</h3>
                <h5>Price: Rs. {{ p.price }}</h5>
                <p>{{ p.description }}</p>

                <div class="quantity">
                    <!-- Quantity Input Field -->
                    <input type="number" id="product-quantity" value="1" min="1" max="{{ p.stock_count }}"
                        oninput="validateQuantity(this)">
                    <br>
                    <input type="hidden" value="{{ p.pid }}" id="product-id" name="product-id">
                    <input type="hidden" value="{{ p.title }}" id="product-title" name="product-title">

                    <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">

                    <!-- Conditional Buttons for Authenticated/Unauthenticated Users -->
                    {% if user.is_authenticated %}
                    <button type="button" id="add-to-cart-btn" onclick="addToCart()">Add to Cart</button>
                    {% else %}
                    <a href="{% url 'auth' %}" class="btn btn-primary">Please sign in to add to cart</a>
                    {% endif %}
                </div>

                <!-- Product Details -->
                <div>
                    <p>Delivery:</p>
                    <p>Free standard shipping on orders over Rs.35 before tax, plus free returns.</p>
                    <div class="delivery">
                        <p>MFD</p>
                        <p>{{ p.mfg_date }}</p>
                    </div>
                    <hr>
                    <div class="delivery">
                        <p>Life</p>
                        <p>{{ p.life }}</p>
                    </div>
                    <hr>
                    <div class="delivery">
                        <p>Stock</p>
                        <p>{{ p.stock_count }} KG</p>
                    </div>
                    <hr>
                </div>
            </div>
        </div>

    </section>

    <!-- Start Footer  -->
    <footer>
        <div class="footer-main">
            <div class="container">
                <div class="row">
                    <div class="col-lg-4 col-md-12 col-sm-12">
                        <div class="footer-top-box">
                            <h3>Business Time</h3>
                            <ul class="list-time">
                                <li>Monday - Friday: 08.00am to 05.00pm</li>
                                <li>Saturday: 10.00am to 08.00pm</li>
                                <li>Sunday: <span>Closed</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-12 col-sm-12">
                        <div class="footer-top-box">
                            <h3>Newsletter</h3>
                            <form class="newsletter-box">
                                <div class="form-group">
                                    <input class="" type="email" name="Email" placeholder="Email Address*" />
                                    <i class="fa fa-envelope"></i>
                                </div>
                                <button class="btn hvr-hover" type="submit">Submit</button>
                            </form>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-12 col-sm-12">
                        <div class="footer-top-box">
                            <h3>Social Media</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                            <ul>
                                <li><a href="#"><i class="fab fa-facebook" aria-hidden="true"></i></a></li>
                                <li><a href="#"><i class="fab fa-twitter" aria-hidden="true"></i></a></li>
                                <li><a href="#"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li>
                                <li><a href="#"><i class="fab fa-google-plus" aria-hidden="true"></i></a></li>
                                <li><a href="#"><i class="fa fa-rss" aria-hidden="true"></i></a></li>
                                <li><a href="#"><i class="fab fa-pinterest-p" aria-hidden="true"></i></a></li>
                                <li><a href="#"><i class="fab fa-whatsapp" aria-hidden="true"></i></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-lg-4 col-md-12 col-sm-12">
                        <div class="footer-widget">
                            <h4>About PlantPulse</h4>
                            <p>PlantPulse offers a fresh, convenient marketplace where you can buy and sell quality
                                tomatoes directly from trusted sources. Our platform connects farmers and buyers,
                                ensuring access to fresh produce while supporting sustainable agriculture. Shopping for
                                tomatoes with PlantPulse is quick, easy, and helps foster a healthier farming community.
                            </p>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-12 col-sm-12">
                        <div class="footer-link">
                            <h4>Information</h4>
                            <ul>
                                <li><a href="#">About Us</a></li>
                                <li><a href="#">Customer Service</a></li>
                                <li><a href="#">Our Sitemap</a></li>
                                <li><a href="#">Terms &amp; Conditions</a></li>
                                <li><a href="#">Privacy Policy</a></li>
                                <li><a href="#">Delivery Information</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-12 col-sm-12">
                        <div class="footer-link-contact">
                            <h4>Contact Us</h4>
                            <ul>
                                <li>
                                    <p><i class="fas fa-map-marker-alt"></i>Address: PlantPulse Technologies <br> Office
                                        No. 12, 4th Floor <br>Tech Park One, Yerawada,<br>Pune, Maharashtra - 411006,
                                        India </p>
                                </li>
                                <li>
                                    <p><i class="fas fa-phone-square"></i>Phone: <a href="tel:+1-888705770"> +91-98765
                                            43210</a></p>
                                </li>
                                <li>
                                    <p><i class="fas fa-envelope"></i>Email: <a
                                            href="mailto:contactinfo@gmail.com">support@plantpulse.in</a></p>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- End Footer  -->

    <!-- Start copyright  -->
    <div class="footer-copyright">
        <p class="footer-company">All Rights Reserved. &copy; 2024 <a href="#">PlantPulse</a> Design By : Team
    </div>
    <!-- End copyright  -->

    <a href="#" id="back-to-top" title="Back to top" style="display: none;">&uarr;</a>

    <!-- ALL JS FILES -->
    <script src="{% static 'js/jquery-3.2.1.min.js' %}"></script>
    <script src="{% static 'js/popper.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <!-- ALL PLUGINS -->
    <script src="{% static 'js/jquery.superslides.min.js' %}"></script>
    <script src="{% static 'js/bootstrap-select.js' %}"></script>
    <script src="{% static 'js/inewsticker.js' %}"></script>
    <script src="{% static 'js/bootsnav.js.' %}"></script>
    <script src="{% static 'js/images-loded.min.js' %}"></script>
    <script src="{% static 'js/isotope.min.js' %}"></script>
    <script src="{% static 'js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'js/baguetteBox.min.js' %}"></script>
    <script src="{% static 'js/form-validator.min.js' %}"></script>
    <script src="{% static 'js/contact-form-script.js' %}"></script>
    <script src="{% static 'js/custom.js' %}"></script>
    <script src="{% static 'js/cart.js' %}"></script>

    <script>
        // Ensure the quantity entered does not exceed the available stock
        function validateQuantity(input) {
            const max = parseInt(input.max);
            const value = parseInt(input.value);
            if (value > max) {
                input.value = max; // Reset to max if the input exceeds stock
                alert(`Maximum available stock is ${max}.`);
            }
        }

        function addToCart() {
            const quantity = document.getElementById("product-quantity").value;
            const productId = document.getElementById("product-id").value;
            const csrfToken = document.querySelector('input[name="csrfmiddlewaretoken"]').value;

            fetch("/add-to-cart/", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRFToken": csrfToken,
                },
                body: JSON.stringify({ product_id: productId, quantity: quantity }),
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert("Product added to cart!");
                        location.reload();
                    } else {
                        alert(data.error);
                    }
                })
                .catch(error => console.error("Error:", error));
        }
    </script>
</body>

</html>